<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Contracts - FEDEVENT</title>
    <link rel="stylesheet" href="/site.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--ink-2);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: #111827;
        }

        .back-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-btn:hover {
            background: #4b5563;
        }

        .contracts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .contract-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .contract-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .contract-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .contract-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.5rem;
        }

        .contract-id {
            font-size: 0.875rem;
            color: #6b7280;
            font-family: monospace;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-active {
            background: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-completed {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-expired {
            background: #fee2e2;
            color: #991b1b;
        }

        .contract-details {
            margin: 1rem 0;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .detail-label {
            color: #6b7280;
            font-weight: 500;
        }

        .detail-value {
            color: #111827;
            font-weight: 600;
        }

        .contract-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #1f2937;
            color: white;
        }

        .btn-primary:hover {
            background: #111827;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .filter-bar {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            font-size: 0.875rem;
        }

        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            font-size: 0.875rem;
            min-width: 200px;
        }

        .contract-progress {
            margin-top: 1rem;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #10b981;
        }

        .progress-title {
            font-weight: 600;
            color: #111827;
            margin-bottom: 0.5rem;
        }

        .progress-steps {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
        }

        .progress-step {
            color: #6b7280;
        }

        .progress-step.completed {
            color: #10b981;
            font-weight: 500;
        }

        .progress-step.current {
            color: #1f2937;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .contracts-grid {
                grid-template-columns: 1fr;
            }
            
            .page-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">üìù Hotel Contracts</h1>
            <a href="/hotel-dashboard.html" class="back-btn">
                ‚Üê Back to Dashboard
            </a>
        </div>

        <div class="filter-bar">
            <select class="filter-select" id="statusFilter">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="pending">Pending</option>
                <option value="completed">Completed</option>
                <option value="expired">Expired</option>
            </select>
            <select class="filter-select" id="agencyFilter">
                <option value="">All Agencies</option>
                <option value="dod">Department of Defense</option>
                <option value="education">Department of Education</option>
                <option value="homeland">Department of Homeland Security</option>
                <option value="veterans">Department of Veterans Affairs</option>
            </select>
            <input type="text" class="search-input" id="searchInput" placeholder="Search contracts...">
            <button class="btn btn-primary" onclick="refreshContracts()">
                üîÑ Refresh
            </button>
        </div>

        <div id="contractsContainer">
            <div class="contracts-grid" id="contractsGrid">
                <!-- Contracts will be loaded here -->
            </div>
        </div>

        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üìù</div>
            <h3>No Contracts Found</h3>
            <p>You don't have any active contracts yet. Check the bidding opportunities section for new contract opportunities.</p>
        </div>
    </div>

    <script>
        // Sample contract data - replace with API calls
        const sampleContracts = [
            {
                id: 'CONTRACT-2025-001',
                title: 'Federal Employee Training Conference',
                agency: 'Department of Education',
                status: 'active',
                startDate: '2025-03-15',
                endDate: '2025-03-18',
                value: '$25,000',
                rooms: 50,
                nightlyRate: '$120',
                description: 'Annual training conference for federal education employees',
                progress: {
                    current: 'execution',
                    steps: [
                        { name: 'Contract Signed', status: 'completed' },
                        { name: 'Booking Confirmed', status: 'completed' },
                        { name: 'Service Execution', status: 'current' },
                        { name: 'Final Payment', status: 'pending' }
                    ]
                }
            },
            {
                id: 'CONTRACT-2025-002',
                title: 'Military Leadership Summit',
                agency: 'Department of Defense',
                status: 'pending',
                startDate: '2025-04-20',
                endDate: '2025-04-22',
                value: '$45,000',
                rooms: 75,
                nightlyRate: '$135',
                description: 'Leadership development summit for military personnel',
                progress: {
                    current: 'review',
                    steps: [
                        { name: 'Bid Submitted', status: 'completed' },
                        { name: 'Under Review', status: 'current' },
                        { name: 'Contract Signing', status: 'pending' },
                        { name: 'Service Execution', status: 'pending' }
                    ]
                }
            },
            {
                id: 'CONTRACT-2024-015',
                title: 'Veterans Healthcare Conference',
                agency: 'Department of Veterans Affairs',
                status: 'completed',
                startDate: '2024-12-10',
                endDate: '2024-12-12',
                value: '$35,000',
                rooms: 60,
                nightlyRate: '$115',
                description: 'Healthcare innovation conference for VA staff',
                progress: {
                    current: 'completed',
                    steps: [
                        { name: 'Contract Signed', status: 'completed' },
                        { name: 'Service Delivered', status: 'completed' },
                        { name: 'Payment Received', status: 'completed' },
                        { name: 'Contract Closed', status: 'completed' }
                    ]
                }
            }
        ];

        let contracts = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìù Hotel Contracts page initializing...');
            loadContracts();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('statusFilter').addEventListener('change', filterContracts);
            document.getElementById('agencyFilter').addEventListener('change', filterContracts);
            document.getElementById('searchInput').addEventListener('input', filterContracts);
        }

        // Load contracts
        async function loadContracts() {
            try {
                // For now, use sample data
                contracts = sampleContracts;
                renderContracts(contracts);
                
                // TODO: Replace with actual API call
                /*
                const sessionId = localStorage.getItem('fedevent_session');
                const response = await fetch('/api/hotel/contracts', {
                    headers: {
                        'Authorization': `Bearer ${sessionId}`
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    contracts = result.contracts || [];
                    renderContracts(contracts);
                } else {
                    showEmptyState();
                }
                */
            } catch (error) {
                console.error('Error loading contracts:', error);
                showEmptyState();
            }
        }

        // Render contracts
        function renderContracts(contractList) {
            const grid = document.getElementById('contractsGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (contractList.length === 0) {
                showEmptyState();
                return;
            }
            
            emptyState.style.display = 'none';
            grid.innerHTML = '';
            
            contractList.forEach(contract => {
                const card = createContractCard(contract);
                grid.appendChild(card);
            });
        }

        // Create contract card
        function createContractCard(contract) {
            const card = document.createElement('div');
            card.className = 'contract-card';
            
            const progressSteps = contract.progress ? contract.progress.steps.map(step => 
                `<span class="progress-step ${step.status}">${step.name}</span>`
            ).join(' ‚Üí ') : '';
            
            card.innerHTML = `
                <div class="contract-header">
                    <div>
                        <div class="contract-title">${contract.title}</div>
                        <div class="contract-id">${contract.id}</div>
                    </div>
                    <div class="status-badge status-${contract.status}">
                        ${contract.status.charAt(0).toUpperCase() + contract.status.slice(1)}
                    </div>
                </div>
                
                <div class="contract-details">
                    <div class="detail-row">
                        <span class="detail-label">Agency:</span>
                        <span class="detail-value">${contract.agency}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Event Dates:</span>
                        <span class="detail-value">${formatDate(contract.startDate)} - ${formatDate(contract.endDate)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Contract Value:</span>
                        <span class="detail-value">${contract.value}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Room Nights:</span>
                        <span class="detail-value">${contract.rooms}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Nightly Rate:</span>
                        <span class="detail-value">${contract.nightlyRate}</span>
                    </div>
                </div>
                
                <p style="color: #6b7280; font-size: 0.875rem; margin: 1rem 0;">
                    ${contract.description}
                </p>
                
                ${contract.progress ? `
                    <div class="contract-progress">
                        <div class="progress-title">Contract Progress</div>
                        <div class="progress-steps">${progressSteps}</div>
                    </div>
                ` : ''}
                
                <div class="contract-actions">
                    <button class="btn btn-primary" onclick="viewContract('${contract.id}')">
                        üëÅÔ∏è View Details
                    </button>
                    <button class="btn btn-secondary" onclick="downloadContract('${contract.id}')">
                        üìÑ Download Contract
                    </button>
                    ${contract.status === 'pending' ? 
                        `<button class="btn btn-success" onclick="signContract('${contract.id}')">
                            ‚úçÔ∏è Sign Contract
                        </button>` : ''
                    }
                    ${contract.status === 'active' ? 
                        `<button class="btn btn-secondary" onclick="manageBooking('${contract.id}')">
                            üè® Manage Booking
                        </button>` : ''
                    }
                </div>
            `;
            
            return card;
        }

        // Filter contracts
        function filterContracts() {
            const statusFilter = document.getElementById('statusFilter').value;
            const agencyFilter = document.getElementById('agencyFilter').value;
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();
            
            let filtered = contracts;
            
            // Filter by status
            if (statusFilter) {
                filtered = filtered.filter(contract => contract.status === statusFilter);
            }
            
            // Filter by agency
            if (agencyFilter) {
                filtered = filtered.filter(contract => 
                    contract.agency.toLowerCase().includes(agencyFilter) ||
                    contract.agency.toLowerCase().replace(/\s/g, '').includes(agencyFilter)
                );
            }
            
            // Filter by search query
            if (searchQuery) {
                filtered = filtered.filter(contract => 
                    contract.title.toLowerCase().includes(searchQuery) ||
                    contract.agency.toLowerCase().includes(searchQuery) ||
                    contract.id.toLowerCase().includes(searchQuery) ||
                    contract.description.toLowerCase().includes(searchQuery)
                );
            }
            
            renderContracts(filtered);
        }

        // Show empty state
        function showEmptyState() {
            document.getElementById('contractsGrid').innerHTML = '';
            document.getElementById('emptyState').style.display = 'block';
        }

        // View contract details
        function viewContract(contractId) {
            const contract = contracts.find(c => c.id === contractId);
            if (contract) {
                const progressInfo = contract.progress ? 
                    `\n\nCurrent Status: ${contract.progress.current}\nProgress: ${contract.progress.steps.map(s => `${s.name} (${s.status})`).join(', ')}` 
                    : '';
                
                alert(`Contract Details:

Title: ${contract.title}
Agency: ${contract.agency}
Status: ${contract.status}
Value: ${contract.value}
Event Dates: ${contract.startDate} to ${contract.endDate}
Room Nights: ${contract.rooms}
Nightly Rate: ${contract.nightlyRate}${progressInfo}

Full contract management interface coming soon!`);
            }
        }

        // Download contract
        function downloadContract(contractId) {
            alert(`Downloading contract ${contractId}...\n\nDocument download functionality coming soon!`);
        }

        // Sign contract
        function signContract(contractId) {
            const contract = contracts.find(c => c.id === contractId);
            if (contract && confirm(`Sign contract "${contract.title}"?\n\nThis will mark the contract as accepted and begin the service delivery process.`)) {
                // Update contract status to active
                contract.status = 'active';
                if (contract.progress) {
                    contract.progress.current = 'execution';
                    contract.progress.steps.forEach(step => {
                        if (step.name === 'Contract Signing') step.status = 'completed';
                        if (step.name === 'Service Execution') step.status = 'current';
                    });
                }
                renderContracts(contracts);
                alert('Contract signed successfully!\n\nYou will receive a confirmation email with next steps.');
            }
        }

        // Manage booking
        function manageBooking(contractId) {
            const contract = contracts.find(c => c.id === contractId);
            if (contract) {
                alert(`Booking Management for "${contract.title}"

Booking management interface coming soon!

Features will include:
- Room block management
- Guest services coordination
- Event logistics support
- Real-time communication`);
            }
        }

        // Refresh contracts
        function refreshContracts() {
            console.log('üîÑ Refreshing contracts...');
            loadContracts();
        }

        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        console.log('üìù Hotel Contracts page loaded');
    </script>
    
    <script src="/nav.js"></script>
</body>
</html>