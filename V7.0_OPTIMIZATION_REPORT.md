# V7.0 OPTIMIZATION & CLEANUP REPORT
**Date:** October 13, 2025
**Backup Created:** server.v7.0.js (415KB)

## SUMMARY
This report identifies unnecessary files, redundant dependencies, and optimization opportunities for the FedEvent system. All changes are NON-BREAKING and preserve current functionality.

---

## 1. BACKUP FILES TO REMOVE (Safe to Delete)

### Old Server Backups
- ‚ùå `server 2.js` (294KB, Oct 7) - Superseded by v7.0
- ‚ùå `server.js.backup` - Duplicate backup
- ‚ùå `server.js.bak` - Duplicate backup
- ‚úÖ **KEEP:** `server.v7.0.js` (NEW - Current backup)
- ‚úÖ **KEEP:** `server.v7.7.js` (313KB - Reference version)

### Empty Log Files (All 0 bytes)
- ‚ùå `server-debug.log`
- ‚ùå `server-output.log`
- ‚ùå `server-startup.log`
- ‚ùå `server.log`

**Note:** Log rotation is handled by `scripts/log-rotation.js`

---

## 2. TEMPORARY FILES TO CLEAN

### Uploads Directory (58 files, 12KB total)
Multiple temporary OCR processing files that should be cleaned:
- Pattern: `*.ocr.[timestamp].pdf` (OCR output PDFs)
- Pattern: `*.txt.[timestamp].txt` (OCR text sidecars)
- **Recommendation:** Add cleanup cron job or auto-delete after 24 hours

---

## 3. UNUSED NPM DEPENDENCIES

### Packages NOT Used in Current Codebase
```json
{
  "aws-sdk": "^2.1692.0",          // ‚ùå NOT FOUND in server.js
  "bcrypt": "^6.0.0",              // ‚ùå DUPLICATE - using bcryptjs instead
  "stripe": "^17.5.0",             // ‚ùå NOT FOUND in server.js
  "file-type": "^21.0.0",          // ‚ùå NOT FOUND in server.js
  "http-errors": "^2.0.0"          // ‚ùå NOT FOUND in server.js
}
```

### Dependencies Actually Used
‚úÖ bcryptjs, express, cors, multer, better-sqlite3, nodemailer, qrcode
‚úÖ Lazy-loaded: mammoth, unzipper, pdfjs-dist, tesseract.js, openai, sharp, pdf-lib
‚úÖ Available but commented: intuit-oauth, node-quickbooks (for future use)

### Recommendation
Remove unused dependencies to:
- Reduce `node_modules` size
- Improve `npm install` time
- Reduce security audit surface area
- Clean up package.json

---

## 4. EXCESSIVE DOCUMENTATION (68 Markdown Files)

### Redundant/Overlapping Guides
Many guides cover similar topics. Consolidation recommended:

**Prelaunch Related (6 files - should be 1-2):**
- PRELAUNCH_COMPLETE_SUMMARY.md
- PRELAUNCH_DEPLOYMENT_INSTRUCTIONS.md
- PRELAUNCH_FINAL.md
- PRELAUNCH_GUIDE.md
- PRELAUNCH_UPDATES.md
- PRELAUNCH_WORKFLOW_COMPLETE.md

**QuickBooks Related (5 files - should be 1-2):**
- QUICKBOOKS_AUTO_PAYMENT_SETUP.md
- QUICKBOOKS_ONLINE_INTEGRATION.md
- QUICKBOOKS_PAYMENT_OPTIONS.md
- QUICKBOOKS_PAYMENT_SETUP.md
- QUICKBOOKS_SETUP_GUIDE.md

**Gemini/Extraction Related (5 files - should be 1-2):**
- GEMINI_DATA_EXTRACTION_GUIDE.md
- GEMINI_EXTRACTION_FINAL.md
- GEMINI_INTEGRATION_SUMMARY.md
- GEMINI_SIMPLE_EXTRACTION.md
- FOR_GEMINI_PACKAGE.md

**Deployment Related (4 files - should be 1-2):**
- DEPLOYMENT_GUIDE.md
- DEPLOYMENT_READY.md
- ALTERNATIVE_DEPLOYMENT.md
- PRELAUNCH_DEPLOYMENT_INSTRUCTIONS.md

**OCR Related (3 files - should be 1):**
- HYBRID_OCR_GUIDE.md
- HYBRID_OCR_IMPLEMENTATION_SUMMARY.md
- OCR_FINAL_STATUS.md

**Setup Fee Related (2 files - should be 1):**
- SETUP_FEE_IMPLEMENTATION.md
- SETUP_FEE_SUMMARY.md

### Recommendation
- Archive older versions to `/docs/archive/`
- Keep only the latest/most comprehensive version of each topic
- Create a single `README.md` with links to all active docs

---

## 5. TEST & DEBUG FILES (Can Be Moved to /tests/)

### Test Files (12 files)
- test-ai-assistant.js
- test-csv-import.js
- test-excel.js
- test-google-places-key.js
- test-gsa-api.js
- test-hotel-form.js
- test-new-api-key.js
- test-openai-integration.js
- test-per-diem-data.js
- test-places-api.js
- test-prelaunch.js
- test-registration-flow.js

### Debug Scripts (5 files)
- debug-hotel-form-init.js
- debug-hotel-registration.js
- debug-hotel-session.js
- debug-places-api.js
- debug-sessions.js

### Debug HTML Files (6 in root, 18 in public/)
**Root:**
- debug-per-diem.html
- comprehensive-per-diem-test.html
- final-verification.html
- google-places-troubleshooting-checklist.html
- test-*.html (4 files)

**Public Directory:**
- public/debug-*.html (6 files)
- public/test-*.html (18 files)

### Recommendation
- Move to `/tests/` directory for organization
- These are valuable for development but clutter the root

---

## 6. OTHER FILES TO REVIEW

### Duplicate Package Locks
- ‚ùå `package-lock 2.json` - Old duplicate

### Sample Data Files
- ‚úÖ KEEP: sample-import-data.csv
- ‚úÖ KEEP: sample-prelaunch-contacts.csv
- ‚úÖ KEEP: sample-prelaunch-extract.csv

### Other Files
- `database.sqlite` - Old/unused? (main DB is data/creata.db)
- `prelaunch-server.js` - Is this still used or merged into server.js?

---

## 7. CODE OPTIMIZATIONS (No Breaking Changes)

### In server.js (11,315 lines)

1. **Duplicate bcrypt Import**
   - Currently importing bcryptjs (GOOD)
   - package.json has BOTH bcrypt AND bcryptjs (REDUNDANT)
   - **Action:** Remove bcrypt from package.json

2. **Lazy Loading is Implemented**
   - ‚úÖ Heavy libraries (mammoth, tesseract, pdfjs) are lazy-loaded
   - ‚úÖ This improves startup time significantly

3. **Log Rotation is Implemented**
   - ‚úÖ Using `scripts/log-rotation.js`
   - ‚úÖ Imported in server.js

---

## 8. IMMEDIATE SAFE CLEANUP ACTIONS

### ‚úÖ Can Delete Immediately (No Risk)
1. Empty log files (4 files, 0 bytes each)
2. Old server backups (keep only v7.0 and v7.7)
3. package-lock 2.json
4. Temporary OCR files in uploads/

### ‚ö†Ô∏è Recommended (Review First)
1. Remove unused npm dependencies
2. Consolidate documentation files
3. Move test/debug files to organized directory
4. Check if database.sqlite is needed

### üîç Requires Testing Before Removal
1. prelaunch-server.js
2. Various test HTML files (may be used for manual testing)

---

## 9. ESTIMATED SPACE SAVINGS

- Old backups: ~600KB
- Empty logs: 0KB (but cleaner)
- Temp OCR files: ~12KB
- Unused node_modules (aws-sdk, stripe, etc.): ~50-100MB
- Documentation consolidation: ~500KB
- **Total Estimated Savings: 50-100MB+**

---

## 10. NEXT STEPS

### Phase 1: Safe Cleanup (Do Now)
```bash
# Remove empty logs
rm server-debug.log server-output.log server-startup.log server.log

# Remove old backups (keeping v7.0 and v7.7)
rm "server 2.js" server.js.backup server.js.bak

# Remove duplicate package lock
rm "package-lock 2.json"

# Clean temporary OCR files
find uploads -name "*.ocr.*.pdf" -delete
find uploads -name "*.txt.*.txt" -delete
```

### Phase 2: Dependency Cleanup (Test After)
```bash
npm uninstall aws-sdk bcrypt stripe file-type http-errors
npm install  # Rebuild package-lock.json
```

### Phase 3: Organization (Optional)
```bash
# Create test directory
mkdir -p tests
mv test-*.js tests/
mv debug-*.js tests/
mv test-*.html tests/
mv debug-*.html tests/

# Create docs archive
mkdir -p docs/archive
# Move superseded documentation files
```

---

## CONCLUSION

The system is well-structured but has accumulated development artifacts. The optimizations listed here will:
- ‚úÖ Reduce disk usage
- ‚úÖ Speed up npm operations
- ‚úÖ Improve organization
- ‚úÖ Maintain all functionality
- ‚úÖ Keep important backups (v7.0, v7.7)

**All recommendations are non-breaking and reversible.**

